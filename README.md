# multigrid
Multigrid method for the Poisson problem with extensibility in mind


## Build
Has the following dependencies:
  * *C++20 compiler*
  * *OpenMP:* for cpu parallelization of solvers
  * *Eigen*: for direct solving of sparse linear systems (>=3.3)
  * [google benchmark:](https://github.com/google/benchmark) for measuring solvers performance (last version should work fine)
  * *python 3 + numpy + matplotlib + pandas*: for plotting experimental results
  * [sympy](https://www.sympy.org): for producing symbolically the exact solution for convergence tests

Compile the examples and tests as a standard cmake project:
```(bash)
mkdir build
cd build
cmake ..
make
```

The `SYCL` branch has a SYCL compiler dependency, further compilation instructions are in `CMakeLists.txt`.


## Overview
The project implements a geometric multigrid solver for 1D and 2D square grids. It uses C++ runtime polimorphism to capture the variability of PDE problems. It essentially boils down to specializing these virtual classes:
  * **Problem**: has knowledge about the discretization used and the system rhs, returns an
  * **Operator**: knows how to relax the solution and can produce a sparse matrix representation of itself
  * **Solver**: given a problem, applies multigrid solver (or an iterative one) to a privately owned solution and is problem & operator agnostic


## Features
  * Extensible design: can solve stencil based discretizations for 1D and 2D problems, given a suitable class implementation
  * Python plotting of experimental results like residual convergence and solve time
  * Convergence tests with problem parameters symbolically generated by sympy
  * Benchmarking of multigrid solver performance with automatic parsing and plotting of results
  * Rich multigrid parameters selection (smoother, cycle, grid transfers...)
  * Jupyter notebook analysis of operator restriction


## Demos
  * `make circuit`: solves a forced RC oscillator circuit and displays the solution
  * `make multilevel`: solves a IsotropicPoisson2D problem with different levels of multigrid and compares their residual converges
  * `make cycle`: compares the convergence of multigrid cycles (full, V, W) on a fixed problem
  * `make convergence_1d`: do a convergence test on the 1D problem defined by the python symbolic generation
  * `make convergence_2d`: do a convergence test on the 2D problem defined by the python symbolic generation
  * `make smoother`: compares the convergence of multigrid solvers on a IsotropicPoisson2D problem varying the smoother and the grid transfer operators

## Benchmarks
  * `make benchmark_omp`: compares multigrid solver on increasingly bigger problems with redblack smoother with different number of openmp threads and plots the speedup
  * `make benchmark_vcycle`: compares non parallelizable gauss-seidel multigrid with parallelizable but weaker red-black and SOR multigrid and plots the speedup
  * `make benchmark_cycle`: compares the performance of same depth V, F and W cycles and plot the speedup
  * `make benchmark_fused`: plots the speedup of kernel fusion optimizations against openmp best multigrid solver
